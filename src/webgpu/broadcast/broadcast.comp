
layout(local_size_x = LOCAL_SIZE) in;

layout(set = 0, binding = 0) readonly buffer X {
    T[] x;
};

layout(set = 0, binding = 1) writeonly buffer Y {
    T[] y;
};

layout(push_constant) uniform PushConsts {
    uint len;
    uint nclasses;
};

void main() {
    uint tid = gl_GlobalInvocationID.x;
    
    if (tid < len) {
        y[tid] = x[tid % nclasses];
    }
}
